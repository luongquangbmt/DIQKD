<!DOCTYPE html>
<html lang="">
  <head>
    <title>OpenQSDS_000-code</title>
    <meta name="generator" content="wxMaxima"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/x-mathjax-config">  MathJax.Hub.Config({
    displayAlign: "left",
    context: "MathJax",
    TeX: {TagSide: "left"}
  })
</script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async="async">  // A comment that hinders wxWidgets from optimizing this tag too much.
</script>
    <link rel="stylesheet" type="text/css" href="OpenQSDS_000-code_htmlimg/OpenQSDS_000-code.css"/>
  </head>
  <body>
    <!-- ****************************************************** -->
    <!-- *        Created with wxMaxima version 21.05.2       * -->
    <!-- ****************************************************** -->
    <noscript>
      <div class="error message">
        <p>Please enable JavaScript in order to get a 2d display of the equations embedded in this web page.</p>
      </div>
    </noscript>
    <p hidden="hidden">\(      \DeclareMathOperator{\abs}{abs}
      \newcommand{\ensuremath}[1]{\mbox{$#1$}}
\)</p>
    <!-- Section cell -->
    <div class="section">
      <p>  1 Scalar product
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Scalar product of two complex vectors
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">scalar_prod</span>
            <span class="code_operator">(</span>
            <span class="code_variable">u</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">v</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_function">conjugate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">u</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">v</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Section cell -->
    <div class="section">
      <p>  2 Tensor product
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Tensor product of two matrices
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">tensor_prod</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">Size</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">r1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">c1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">r2</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">c2</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">r</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">c</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">M</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">Size</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix_size</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">r1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">Size</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">c1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">Size</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">Size</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix_size</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">r2</span>
            <span class="code_operator">:</span>
            <span class="code_variable">Size</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">c2</span>
            <span class="code_operator">:</span>
            <span class="code_variable">Size</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">r</span>
            <span class="code_operator">:</span>
            <span class="code_variable">r1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">r2</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">c</span>
            <span class="code_operator">:</span>
            <span class="code_variable">c1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">c2</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">M</span>
            <span class="code_operator">:</span>
            <span class="code_function">zeromatrix</span>
            <span class="code_operator">(</span>
            <span class="code_variable">r</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">c</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">r</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">c</span>
            <span class="code_function">do</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">M</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">M1</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">+</span>
            <span class="code_function">floor</span>
            <span class="code_operator">(</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_variable">r2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">+</span>
            <span class="code_function">floor</span>
            <span class="code_operator">(</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_variable">c2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_endofline">
              <br/>
            </span>                       
            <span class="code_variable">M2</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">+</span>
            <span class="code_function">mod</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">r2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">+</span>
            <span class="code_function">mod</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">c2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">M</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Section cell -->
    <div class="section">
      <p>  3 Quantum computing module
</p>
    </div>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.1 Initialization of n_qubit 
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Initialize the n-qubit, putting it in the state |0&gt;, resets the variables max_error_n_qubit, max_error_gate, max_error_prob, system_error, graphic_list and graphic_in_sesion and initialize the random generator
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">initialize_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">max_error_n_qubit</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">max_error_gates</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">max_error_prob</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"none"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_operator">[</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_operator">:</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">set_random_state</span>
            <span class="code_operator">(</span>
            <span class="code_function">make_random_state</span>
            <span class="code_operator">(</span>
            <span class="code_function">true</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.2 N-qubit norm check
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Calculate the error of the n_qubit and update max_error_n_qubit
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">check_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">norm</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">norm</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">do</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">norm</span>
            <span class="code_operator">:</span>
            <span class="code_variable">norm</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">abs</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">−</span>
            <span class="code_variable">norm</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_variable">max_error_n_qubit</span>
            <span class="code_function">then</span>
            <span class="code_variable">max_error_n_qubit</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">norm</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.3 One-qubit quantum gates
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Definition of 1-qubit quantum gates
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_H</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_I</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_X</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_Y</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_Z</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_S</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_T</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">gate_R</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">exp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">%pi</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">gate_P</span>
            <span class="code_operator">(</span>
            <span class="code_variable">φ</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                       
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">exp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">φ</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">gate_Ry</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_operator">−</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">gate_Rz</span>
            <span class="code_operator">(</span>
            <span class="code_variable">α</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">exp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">α</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">exp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">α</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">gate_Ph</span>
            <span class="code_operator">(</span>
            <span class="code_variable">δ</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">exp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">δ</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">exp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">δ</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">gate_Error</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">θ1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">θ2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_operator">−</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">−</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_function">sin</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_function">cos</span>
            <span class="code_operator">(</span>
            <span class="code_variable">θ1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.4 Two-qubit quantum gates
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Definition of 2-qubit quantum gates
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gate_swap</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                              
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                              
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                              
            <span class="code_operator">[</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.5 Quantum gate unitary check
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">One-qubit quantum gates
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">check_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">M2</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">w</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">err</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">err</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">M2</span>
            <span class="code_operator">:</span>
            <span class="code_variable">M1</span>
            <span class="code_endofline">.</span>
            <span class="code_function">conjugate</span>
            <span class="code_operator">(</span>
            <span class="code_function">traspose</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_number">2</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_number">2</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">j</span>
            <span class="code_operator">=</span>
            <span class="code_variable">k</span>
            <span class="code_function">then</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">−</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">else</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">w</span>
            <span class="code_operator">:</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">+</span>
            <span class="code_variable">y</span>
            <span class="code_operator">·</span>
            <span class="code_variable">y</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">err</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">w</span>
            <span class="code_function">then</span>
            <span class="code_variable">err</span>
            <span class="code_operator">:</span>
            <span class="code_variable">w</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">max_error_gates</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">err</span>
            <span class="code_function">then</span>
            <span class="code_variable">max_error_gates</span>
            <span class="code_operator">:</span>
            <span class="code_variable">err</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">err</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Two-qubit quantum gates
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">check_2_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">M2</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">w</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">err</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">err</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">M2</span>
            <span class="code_operator">:</span>
            <span class="code_variable">M1</span>
            <span class="code_endofline">.</span>
            <span class="code_function">conjugate</span>
            <span class="code_operator">(</span>
            <span class="code_function">traspose</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_number">4</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_number">4</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">j</span>
            <span class="code_operator">=</span>
            <span class="code_variable">k</span>
            <span class="code_function">then</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">−</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">else</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">M2</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">w</span>
            <span class="code_operator">:</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">+</span>
            <span class="code_variable">y</span>
            <span class="code_operator">·</span>
            <span class="code_variable">y</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">err</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">w</span>
            <span class="code_function">then</span>
            <span class="code_variable">err</span>
            <span class="code_operator">:</span>
            <span class="code_variable">w</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">max_error_gates</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">err</span>
            <span class="code_function">then</span>
            <span class="code_variable">max_error_gates</span>
            <span class="code_operator">:</span>
            <span class="code_variable">err</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">err</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.6 Construction of next_base_vector iterator to apply quantum gates/measurements
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Initialize the base vector (qubit_list) and the mask (mask_list) for the qubits of the quantum gate
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">do</span>
            <span class="code_variable">qubit_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">do</span>
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Calculate the following base vector (until the function returns false)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">result</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_number">0</span>
            <span class="code_function">and</span>
            <span class="code_operator">(</span>
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">=</span>
            <span class="code_number">0</span>
            <span class="code_function">or</span>
            <span class="code_variable">qubit_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">=</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_number">0</span>
            <span class="code_function">then</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">qubit_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">do</span>
            <span class="code_variable">qubit_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">result</span>
            <span class="code_operator">:</span>
            <span class="code_function">true</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">result</span>
            <span class="code_operator">:</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">result</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.7 Convert the base vector qubit_list into the index of the n_qubit array
</p>
    </div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">do</span>
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k</span>
            <span class="code_operator">+</span>
            <span class="code_variable">qubit_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Convert list R into an index
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">list_to_index</span>
            <span class="code_operator">(</span>
            <span class="code_variable">R</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">R</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">n</span>
            <span class="code_function">do</span>
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k</span>
            <span class="code_operator">+</span>
            <span class="code_variable">R</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">n</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.8 Convert the index of the n_qubit array into the base vector qubit_list
</p>
    </div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">n_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">mod</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">qubit_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">x</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">qubit_list</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Convert index k into the list R
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">index_to_list</span>
            <span class="code_operator">(</span>
            <span class="code_variable">R</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">R</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">n</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">mod</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">R</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">x</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">R</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.9 Start Simulator
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Assign values to global variables num_qubits, dim_n_qubit and last_base_vector (depending on the
      <br/>number of qubits n entered as a parameter), build the variables n-qubit, qubit_list and mask_list
      <br/>(necessary for the application of quantum gates and quantum measurements) and initialize the n-qubit, the variables max_error_n_qubit, max_error_gates, max_error_prob, system_error, graphic_list and graphic_in_sesion and initialize the random generator
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">start_simulator</span>
            <span class="code_operator">(</span>
            <span class="code_variable">n</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">last_base_vector</span>
            <span class="code_operator">:</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">:</span>
            <span class="code_function">make_array</span>
            <span class="code_operator">(</span>
            <span class="code_variable">flonum</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_endofline">,</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">qubit_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">max_error_n_qubit</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">max_error_gates</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">max_error_prob</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"none"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_operator">[</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_operator">:</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">set_random_state</span>
            <span class="code_operator">(</span>
            <span class="code_function">make_random_state</span>
            <span class="code_operator">(</span>
            <span class="code_function">true</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.10 Summary
</p>
    </div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">summary</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">sprint</span>
            <span class="code_operator">(</span>
            <span class="code_string">" "</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">newline</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">sprint</span>
            <span class="code_operator">(</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_string">"num_qubits = "</span>
            <span class="code_endofline">,</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">newline</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">sprint</span>
            <span class="code_operator">(</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_string">"dim_n_qubit = "</span>
            <span class="code_endofline">,</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">newline</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">sprint</span>
            <span class="code_operator">(</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_string">"max_error_n_qubit = "</span>
            <span class="code_endofline">,</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">max_error_n_qubit</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">newline</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">sprint</span>
            <span class="code_operator">(</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_string">"max_error_prob = "</span>
            <span class="code_endofline">,</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">max_error_prob</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">newline</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_string">"max_error_gates = "</span>
            <span class="code_endofline">,</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">max_error_gates</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.11 Application of a one-qubit quantum gate
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Check the list of qubits over which a quantum gate is defined
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_variable">L</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">len</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">sol</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">sol</span>
            <span class="code_operator">:</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">len</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">L</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">len</span>
            <span class="code_function">do</span>
            <span class="code_function">if</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">1</span>
            <span class="code_function">or</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">then</span>
            <span class="code_variable">sol</span>
            <span class="code_operator">:</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">len</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_number">1</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">len</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_function">do</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">len</span>
            <span class="code_function">do</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_function">if</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">=</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_function">then</span>
            <span class="code_variable">sol</span>
            <span class="code_operator">:</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">sol</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">The one-qubit quantum gate G is applied to qubit j
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">apply_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">check_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"apply_1_qubit_gate: index j out of range"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">res</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.12 Application of a controlled one-qubit quantum gate
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">The one-qubit quantum gate G is applied to qubit j if qubit j0 is in state |1&gt;
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">apply_1_controlled_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">check_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"apply_1_controlled_1_qubit_gate: indices j0 and j out of range or not distinct"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">res</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.13 Application of a two-controlled one-qubit quantum gate
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">The one-qubit quantum gate G is applied to qubit j if qubits j0 and j1 are in state |1&gt;
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">apply_2_controlled_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">check_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"apply_2_controlled_1_qubit_gate: indices j0, j1 and j out of range or not distinct"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">res</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.14 Application of a k controlled qubit quantum gate
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">The one-qubit quantum gate G is applied to qubit j if qubits L[1], L[2], ... are in state |1&gt;
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">apply_k_controlled_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">L</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">len</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">L</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">len</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">L</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">len</span>
            <span class="code_function">do</span>
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">len</span>
            <span class="code_function">do</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_operator">+</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k0_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">check_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"apply_k_controlled_1_qubit_gate: indices out of range or not distinct"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">res</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.15 Application of a two-qubit quantum gate
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">The two-qubit quantum gate G is applied to qubits j1 and j2
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">apply_2_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k2_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k3_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j2</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j2</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k2_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k3_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j2</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k2</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k2_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k3</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k3_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                        
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">4</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">4</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k2</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k2_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k3</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k3_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">:</span>
            <span class="code_function">matrix</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                            
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">%i</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">:</span>
            <span class="code_function">expand</span>
            <span class="code_operator">(</span>
            <span class="code_variable">G</span>
            <span class="code_endofline">.</span>
            <span class="code_variable">ψ_in</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k2</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">realpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">4</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k3</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">imagpart</span>
            <span class="code_operator">(</span>
            <span class="code_variable">ψ_out</span>
            <span class="code_operator">[</span>
            <span class="code_number">4</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">check_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"apply_2_qubit_gate: indices j1 and j2 out of range or not distinct"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">res</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.16 Application of qubit measures
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">The one-qubit measure is applied to qubit j
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">apply_1_qubit_measure</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">p0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">p1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">final_res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1_offset</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">p0</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">p1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">p0</span>
            <span class="code_operator">:</span>
            <span class="code_variable">p0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">p1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">p1</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">random</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">p0</span>
            <span class="code_function">then</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">res</span>
            <span class="code_operator">=</span>
            <span class="code_number">0</span>
            <span class="code_function">then</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_variable">p0</span>
            <span class="code_operator">)</span>
            <span class="code_function">else</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_function">sqrt</span>
            <span class="code_operator">(</span>
            <span class="code_variable">p1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">res</span>
            <span class="code_operator">=</span>
            <span class="code_number">0</span>
            <span class="code_function">then</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k0</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">k1_offset</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">res</span>
            <span class="code_operator">=</span>
            <span class="code_number">0</span>
            <span class="code_function">then</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">check_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">abs</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">−</span>
            <span class="code_variable">p0</span>
            <span class="code_operator">−</span>
            <span class="code_variable">p1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">max_error_prob</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">x</span>
            <span class="code_function">then</span>
            <span class="code_variable">max_error_prob</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">final_res</span>
            <span class="code_operator">:</span>
            <span class="code_operator">[</span>
            <span class="code_variable">p0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">p1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">final_res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"apply_1_qubit_measure: index j out of range"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">final_res</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">All qubits of the register j0 ... j1 are measured. Returns the list [[b_1, b_2, ..., b_k], res] where the first element is the list of bits resulting from the measurements (k = j1-j0+1) and res is the integer with binary representation b_1b_2...b_k.
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">apply_reg_measure</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">reg_len</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_2</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">index</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">final_res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">j1</span>
            <span class="code_function">and</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">reg_len</span>
            <span class="code_operator">:</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res_1</span>
            <span class="code_operator">:</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">reg_len</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">apply_1_qubit_measure</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">res_1</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">x</span>
            <span class="code_operator">[</span>
            <span class="code_number">3</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res_2</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">reg_len</span>
            <span class="code_function">do</span>
            <span class="code_variable">res_2</span>
            <span class="code_operator">:</span>
            <span class="code_variable">res_2</span>
            <span class="code_operator">+</span>
            <span class="code_variable">res_1</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">reg_len</span>
            <span class="code_operator">−</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">final_res</span>
            <span class="code_operator">:</span>
            <span class="code_operator">[</span>
            <span class="code_variable">res_1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_2</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">final_res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"apply_reg_measure: index j0 &gt;= j1 or indices j0 and j1 out of range"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">final_res</span>    
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.17 Walsh-Hadamard transformation
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Apply the Walsh-Hadamard transformation to register j0...j1.
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">WH_transformation</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">j1</span>
            <span class="code_function">and</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_function">do</span>
            <span class="code_function">apply_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">gate_H</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"WH_transformation: index j0 &gt;= j1 or indices j0 and j1 out of range"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">res</span>    
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.18 Quantum Fourier transformation
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Apply the Quantum Fourier transformation to register j0...j1.
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">QF_transformation</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">if</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">j1</span>
            <span class="code_function">and</span>
            <span class="code_function">check_gate_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>   
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_function">do</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">apply_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">gate_H</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_function">do</span>
            <span class="code_function">apply_1_controlled_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_function">gate_R</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">apply_1_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">gate_H</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_function">mod</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">+</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">,</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">=</span>
            <span class="code_number">0</span>
            <span class="code_function">then</span>
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">−</span>
            <span class="code_number">2</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_function">else</span>
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">/</span>
            <span class="code_number">2</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">k</span>
            <span class="code_function">do</span>
            <span class="code_function">apply_2_qubit_gate</span>
            <span class="code_operator">(</span>
            <span class="code_variable">gate_swap</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">−</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_function">else</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_string">"QF_transformation: index j0 &gt;= j1 or indices j0 and j1 out of range"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_variable">res</span>    
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Subsection cell -->
    <div class="subsect">
      <p>  3.19 Graphics of probabilities and coefficients
</p>
    </div>
    <!-- Text cell -->
    <div class="comment">Function to display the name (name or number) graphical representation
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_graphics</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">n</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_function">stringp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">while</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">n</span>
            <span class="code_operator">)</span>
            <span class="code_function">and</span>
            <span class="code_function">not</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">=</span>
            <span class="code_variable">name</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_variable">n</span>
            <span class="code_function">then</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_string">"error: graphic "</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_string">" not found"</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_operator">(</span>
            <span class="code_function">draw</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">elseif</span>
            <span class="code_function">integerp</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_function">or</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_variable">n</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_string">"error: graphic "</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_string">" not found"</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_operator">(</span>
            <span class="code_function">draw</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">name</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"done"</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Bar diagram of the probability distribution (maximum 8 qubits - 256 bars)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_prob</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">9</span>
            <span class="code_function">then</span>
            <span class="code_function">bock</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">i</span>
            <span class="code_function">from</span>
            <span class="code_number">0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">:</span>
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">+</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">y</span>
            <span class="code_function">then</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_function">abs</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">−</span>
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">max_error_prob</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">y</span>
            <span class="code_function">then</span>
            <span class="code_variable">max_error_prob</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_function">gr2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">i</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">wxdraw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">draw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: none"</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: no more than 8 qubits can be graphically represented"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Bar diagram of the register j0...j1 probability distribution (maximum 8 qubits - 256 bars)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_reg_prob</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_number">1</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">j0</span>
            <span class="code_function">and</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">j1</span>
            <span class="code_function">and</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">and</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">8</span>
            <span class="code_function">then</span>
            <span class="code_function">bock</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">res_len</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_dim</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">last_res</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">two_power</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">L</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">res_len</span>
            <span class="code_operator">:</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">res_dim</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_variable">res_len</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">last_res</span>
            <span class="code_operator">:</span>
            <span class="code_variable">res_dim</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">two_power</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">L</span>
            <span class="code_operator">:</span>
            <span class="code_function">makelist</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_dim</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_res</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">i</span>
            <span class="code_operator">:</span>
            <span class="code_variable">j</span>
            <span class="code_operator">·</span>
            <span class="code_variable">two_power</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_function">do</span>
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">:</span>
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">+</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">y</span>
            <span class="code_function">then</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_function">abs</span>
            <span class="code_operator">(</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">−</span>
            <span class="code_variable">sum_prob</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">max_error_prob</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">y</span>
            <span class="code_function">then</span>
            <span class="code_variable">max_error_prob</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">last_res</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_function">gr2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_dim</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">i</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">wxdraw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_dim</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">draw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">res_dim</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: none"</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: no more than 8 qubits can be graphically represented"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Calculate the probability of |z&gt; in the register j0...j1
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">calculate_reg_prob</span>
            <span class="code_operator">(</span>
            <span class="code_variable">z</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">two_power</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">two_power</span>
            <span class="code_operator">:</span>
            <span class="code_number">2</span>
            <span class="code_operator">^</span>
            <span class="code_operator">(</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">i</span>
            <span class="code_operator">:</span>
            <span class="code_variable">z</span>
            <span class="code_operator">·</span>
            <span class="code_variable">two_power</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">initialize_mask_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_function">do</span>
            <span class="code_variable">mask_list</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">while</span>
            <span class="code_function">next_base_vector</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_function">n_qubit_index</span>
            <span class="code_operator">(</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">y</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Bar diagram of the sublist |j0&gt;...|j1&gt; (j1 - j0 &lt;= 256 bars)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_list_prob</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_number">0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">j0</span>
            <span class="code_function">and</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">j1</span>
            <span class="code_function">and</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">and</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">257</span>
            <span class="code_function">then</span>
            <span class="code_function">bock</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">y</span>
            <span class="code_function">then</span>
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_function">gr2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">j</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">wxdraw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_endofline">
              <br/>
            </span>       
            <span class="code_function">draw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">x</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: none"</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: no more than 256 bars can be graphically represented"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Bar diagram of the j biggest probabilities (j1 &lt;= 32)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_variable">gap_prob</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">0000001</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_biggest_prob</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">33</span>
            <span class="code_function">then</span>
            <span class="code_function">bock</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">res</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">L</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">s</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">y1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_operator">[</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">j1</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_comment">/* Find the largest value (y0) less than or equal to x */</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">y0</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_function">if</span>
            <span class="code_operator">(</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">x</span>
            <span class="code_operator">)</span>
            <span class="code_function">and</span>
            <span class="code_operator">(</span>
            <span class="code_variable">y0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">y</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_variable">y0</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_comment">/* Count the numbern of values in the interval (y0 - gap_prob, y0] */</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_comment">/* Find an element (n0) in the previous interval */</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n</span>
            <span class="code_operator">:</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">n0</span>
            <span class="code_operator">:</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">y1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y0</span>
            <span class="code_operator">−</span>
            <span class="code_variable">gap_prob</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_variable">y</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">+</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">·</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_function">if</span>
            <span class="code_operator">(</span>
            <span class="code_variable">y</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_operator">=</span>
            <span class="code_variable">y0</span>
            <span class="code_operator">)</span>
            <span class="code_function">and</span>
            <span class="code_operator">(</span>
            <span class="code_variable">y1</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">y</span>
            <span class="code_operator">)</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_function">if</span>
            <span class="code_variable">n0</span>
            <span class="code_operator">=</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_function">then</span>
            <span class="code_variable">n0</span>
            <span class="code_operator">:</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_variable">n</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_variable">y1</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">n</span>
            <span class="code_endofline">&gt;</span>
            <span class="code_number">0</span>
            <span class="code_function">then</span>
            <span class="code_variable">res</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">res</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">y0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>    
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_number">200</span>
            <span class="code_endofline">.</span>
            <span class="code_number">0</span>
            <span class="code_operator">/</span>
            <span class="code_variable">res</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">k</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">res</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_operator">[</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">j1</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">k</span>
            <span class="code_function">do</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">L</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_variable">res</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">3</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">s</span>
            <span class="code_operator">:</span>
            <span class="code_string">""</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">for</span>
            <span class="code_variable">k1</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">L</span>
            <span class="code_operator">)</span>
            <span class="code_function">do</span>
            <span class="code_variable">s</span>
            <span class="code_operator">:</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_variable">s</span>
            <span class="code_endofline">,</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">k1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_function">label</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">s</span>
            <span class="code_endofline">,</span>
            <span class="code_number">5</span>
            <span class="code_operator">·</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                                   
            <span class="code_operator">[</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                                    
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_number">10</span>
            <span class="code_operator">·</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_number">10</span>
            <span class="code_operator">·</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">+</span>
            <span class="code_variable">x</span>
            <span class="code_operator">·</span>
            <span class="code_variable">res</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                                   
            <span class="code_operator">[</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_function">label</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">res</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_number">10</span>
            <span class="code_operator">·</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">+</span>
            <span class="code_number">210</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>    
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_function">gr2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">10</span>
            <span class="code_operator">·</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">+</span>
            <span class="code_number">210</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">·</span>
            <span class="code_variable">k</span>
            <span class="code_operator">+</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">points_joined</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                                                               
            <span class="code_variable">xtics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ytics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_left</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_right</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                                                               
            <span class="code_variable">axis_top</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_bottom</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">j1</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">wxdraw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">10</span>
            <span class="code_operator">·</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">+</span>
            <span class="code_number">210</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">·</span>
            <span class="code_variable">k</span>
            <span class="code_operator">+</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">points_joined</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                 
            <span class="code_variable">xtics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ytics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_left</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_right</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_top</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_bottom</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">draw</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">[</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">[</span>
            <span class="code_number">2</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: none"</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: no more than 256 bars can be graphically represented"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">res</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">N-qubit coordinate bar diagram (maximum 8 qubits - 256 bars)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_coor</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">9</span>
            <span class="code_function">then</span>
            <span class="code_function">bock</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">z_min</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">z_max</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">i</span>
            <span class="code_function">from</span>
            <span class="code_number">0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">z_max</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">z_min</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_min</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">z_max</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">z_min</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_min</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                  
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray80</span>
            <span class="code_endofline">,</span>
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">last_base_vector</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_function">gr2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">i</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">wxdraw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">draw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: none"</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: no more than 8 qubits can be graphically represented"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">Coordinate bars corresponding to the sublist |j0&gt;...|j1&gt; (j1 - j0 &lt;= 256 bars)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_list_coor</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">−</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">257</span>
            <span class="code_function">then</span>
            <span class="code_function">bock</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">x</span>
            <span class="code_operator">:</span>
            <span class="code_function">float</span>
            <span class="code_operator">(</span>
            <span class="code_number">0</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_variable">j0</span>
            <span class="code_function">thru</span>
            <span class="code_variable">j1</span>
            <span class="code_function">do</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">z_max</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">z_min</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_min</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">z_max</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">if</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">z_min</span>
            <span class="code_function">then</span>
            <span class="code_variable">z_min</span>
            <span class="code_operator">:</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                  
            <span class="code_function">create_list</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray80</span>
            <span class="code_endofline">,</span>
            <span class="code_function">rectangle</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">0</span>
            <span class="code_endofline">.</span>
            <span class="code_number">5</span>
            <span class="code_endofline">,</span>
            <span class="code_number">0</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">n_qubit</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_function">gr2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">j</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">wxdraw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">draw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">j0</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">+</span>
            <span class="code_number">1</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_min</span>
            <span class="code_endofline">,</span>
            <span class="code_number">1</span>
            <span class="code_endofline">.</span>
            <span class="code_number">1</span>
            <span class="code_operator">·</span>
            <span class="code_variable">z_max</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">fill_color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">gray60</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">line_type</span>
            <span class="code_operator">=</span>
            <span class="code_variable">solid</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">border</span>
            <span class="code_operator">=</span>
            <span class="code_function">true</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: none"</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: no more than 256 coordinates can be graphically represented"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <!-- Text cell -->
    <div class="comment">N-qubit linear combination (maximum 6 qubits - 64 terms)
</div>
    <!-- Code cell -->
    <table>
      <tr>
        <td>
          <span class="prompt"> --&gt;	
  </span>
        </td>
        <td>
          <span class="input">
            <span class="code_function">draw_n_qubit</span>
            <span class="code_operator">(</span>
            <span class="code_variable">name</span>
            <span class="code_operator">)</span>
            <span class="code_operator">:</span>
            <span class="code_operator">=</span>
            <span class="code_function">block</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">if</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">7</span>
            <span class="code_function">then</span>
            <span class="code_function">bock</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">k1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">L</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">a_x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">b_x</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">d_a</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">d_b</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">d_t</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_operator">[</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_number">4</span>
            <span class="code_function">then</span>
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_number">1</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_variable">k1</span>
            <span class="code_operator">:</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_operator">/</span>
            <span class="code_number">4</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">a_x</span>
            <span class="code_operator">:</span>
            <span class="code_string">"+ 1.0000 + 0.0000"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">d_a</span>
            <span class="code_operator">:</span>
            <span class="code_number">17</span>
            <span class="code_operator">·</span>
            <span class="code_number">15</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">d_b</span>
            <span class="code_operator">:</span>
            <span class="code_operator">(</span>
            <span class="code_number">17</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_number">30</span>
            <span class="code_operator">+</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">+</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_number">15</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">d_t</span>
            <span class="code_operator">:</span>
            <span class="code_operator">(</span>
            <span class="code_number">17</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_number">30</span>
            <span class="code_operator">+</span>
            <span class="code_operator">(</span>
            <span class="code_number">2</span>
            <span class="code_operator">+</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">)</span>
            <span class="code_operator">·</span>
            <span class="code_number">30</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">for</span>
            <span class="code_variable">k</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">k1</span>
            <span class="code_function">do</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_function">for</span>
            <span class="code_variable">j</span>
            <span class="code_function">from</span>
            <span class="code_number">0</span>
            <span class="code_function">thru</span>
            <span class="code_number">3</span>
            <span class="code_function">do</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_variable">j1</span>
            <span class="code_operator">:</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_variable">k</span>
            <span class="code_operator">−</span>
            <span class="code_number">1</span>
            <span class="code_operator">)</span>
            <span class="code_operator">+</span>
            <span class="code_variable">j</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_function">if</span>
            <span class="code_variable">j1</span>
            <span class="code_endofline">&lt;</span>
            <span class="code_variable">dim_n_qubit</span>
            <span class="code_function">then</span>
            <span class="code_operator">(</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_variable">L</span>
            <span class="code_operator">:</span>
            <span class="code_function">n_qubit_list</span>
            <span class="code_operator">(</span>
            <span class="code_variable">j1</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_variable">b_x</span>
            <span class="code_operator">:</span>
            <span class="code_string">"|"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_function">for</span>
            <span class="code_variable">i</span>
            <span class="code_function">from</span>
            <span class="code_number">1</span>
            <span class="code_function">thru</span>
            <span class="code_variable">num_qubits</span>
            <span class="code_function">do</span>
            <span class="code_variable">b_x</span>
            <span class="code_operator">:</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_variable">b_x</span>
            <span class="code_endofline">,</span>
            <span class="code_function">string</span>
            <span class="code_operator">(</span>
            <span class="code_variable">L</span>
            <span class="code_operator">[</span>
            <span class="code_variable">i</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_variable">b_x</span>
            <span class="code_operator">:</span>
            <span class="code_function">sconcat</span>
            <span class="code_operator">(</span>
            <span class="code_variable">b_x</span>
            <span class="code_endofline">,</span>
            <span class="code_string">"&gt;"</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_function">if</span>
            <span class="code_variable">j</span>
            <span class="code_operator">=</span>
            <span class="code_number">0</span>
            <span class="code_function">then</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">white</span>
            <span class="code_endofline">,</span>
            <span class="code_function">label</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_string">"|"</span>
            <span class="code_endofline">,</span>
            <span class="code_number">10</span>
            <span class="code_endofline">,</span>
            <span class="code_number">4</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_number">16</span>
            <span class="code_operator">−</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_function">label</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">a_x</span>
            <span class="code_endofline">,</span>
            <span class="code_number">100</span>
            <span class="code_operator">+</span>
            <span class="code_variable">d_a</span>
            <span class="code_operator">+</span>
            <span class="code_variable">j</span>
            <span class="code_operator">·</span>
            <span class="code_variable">d_t</span>
            <span class="code_endofline">,</span>
            <span class="code_number">4</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_number">16</span>
            <span class="code_operator">−</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                            
            <span class="code_operator">[</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_function">label</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_variable">b_x</span>
            <span class="code_endofline">,</span>
            <span class="code_number">100</span>
            <span class="code_operator">+</span>
            <span class="code_variable">d_b</span>
            <span class="code_operator">+</span>
            <span class="code_variable">j</span>
            <span class="code_operator">·</span>
            <span class="code_variable">d_t</span>
            <span class="code_endofline">,</span>
            <span class="code_number">4</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_number">16</span>
            <span class="code_operator">−</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                    
            <span class="code_function">if</span>
            <span class="code_variable">j</span>
            <span class="code_operator">=</span>
            <span class="code_number">3</span>
            <span class="code_function">then</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">balken</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">white</span>
            <span class="code_endofline">,</span>
            <span class="code_function">label</span>
            <span class="code_operator">(</span>
            <span class="code_operator">[</span>
            <span class="code_string">"|"</span>
            <span class="code_endofline">,</span>
            <span class="code_number">190</span>
            <span class="code_operator">+</span>
            <span class="code_number">3</span>
            <span class="code_operator">·</span>
            <span class="code_variable">d_t</span>
            <span class="code_endofline">,</span>
            <span class="code_number">4</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_operator">(</span>
            <span class="code_number">16</span>
            <span class="code_operator">−</span>
            <span class="code_variable">k</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>                
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>            
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">:</span>
            <span class="code_function">append</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_endofline">,</span>
            <span class="code_operator">[</span>
            <span class="code_operator">[</span>
            <span class="code_variable">name</span>
            <span class="code_endofline">,</span>
            <span class="code_function">gr2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">200</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_variable">d_t</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">68</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                                       
            <span class="code_variable">xtics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ytics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_left</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_right</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                                                       
            <span class="code_variable">axis_top</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_bottom</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_operator">]</span>
            <span class="code_operator">]</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">i</span>
            <span class="code_operator">:</span>
            <span class="code_function">length</span>
            <span class="code_operator">(</span>
            <span class="code_variable">graphic_list</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">if</span>
            <span class="code_variable">graphic_in_sesion</span>
            <span class="code_function">then</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">wxdraw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">200</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_variable">d_t</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">68</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>                 
            <span class="code_variable">xtics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ytics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_left</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_right</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_top</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_bottom</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">else</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_function">draw2d</span>
            <span class="code_operator">(</span>
            <span class="code_variable">terminal</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_variable">wxt</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">i</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">xrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">200</span>
            <span class="code_operator">+</span>
            <span class="code_number">4</span>
            <span class="code_operator">·</span>
            <span class="code_variable">d_t</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">yrange</span>
            <span class="code_operator">=</span>
            <span class="code_operator">[</span>
            <span class="code_number">0</span>
            <span class="code_endofline">,</span>
            <span class="code_number">68</span>
            <span class="code_operator">]</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">color</span>
            <span class="code_operator">=</span>
            <span class="code_variable">black</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>               
            <span class="code_variable">xtics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">ytics</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_left</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_right</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_top</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">axis_bottom</span>
            <span class="code_operator">=</span>
            <span class="code_function">false</span>
            <span class="code_endofline">,</span>
            <span class="code_variable">balken</span>
            <span class="code_operator">)</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>        
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: none"</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_operator">)</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_function">else</span>
            <span class="code_variable">system_error</span>
            <span class="code_operator">:</span>
            <span class="code_string">"error: no more than 6-qubits linear combination can be represented"</span>
            <span class="code_endofline">,</span>
            <span class="code_endofline">
              <br/>
            </span>    
            <span class="code_variable">system_error</span>
            <span class="code_endofline">
              <br/>
            </span>
            <span class="code_operator">)</span>
            <span class="code_endofline">$</span>
          </span>
        </td>
      </tr>
    </table>
    <hr/>
    <p>
      <small> Created with 
        <a href="https://wxMaxima-developers.github.io/wxmaxima/">wxMaxima</a>.</small>
    </p>
    <small> The source of this Maxima session can be downloaded 
      <a href="OpenQSDS_000-code_htmlimg/OpenQSDS_000-code.wxmx">here</a>.</small>
  </body>
</html>
